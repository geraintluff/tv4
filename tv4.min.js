!function(a){function b(a,c){if(a===c)return!0;if("object"==typeof a&&"object"==typeof c){if(Array.isArray(a)!=Array.isArray(c))return!1;if(Array.isArray(a)){if(a.length!=c.length)return!1;for(var d=0;d<a.length;d++)if(!b(a[d],c[d]))return!1}else{for(var e in a)if(void 0===c[e]&&void 0!==a[e])return!1;for(var e in c)if(void 0===a[e]&&void 0!==c[e])return!1;for(var e in a)if(!b(a[e],c[e]))return!1}return!0}return!1}function c(a){var b=String(a).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return b?{href:b[0]||"",protocol:b[1]||"",authority:b[2]||"",host:b[3]||"",hostname:b[4]||"",port:b[5]||"",pathname:b[6]||"",search:b[7]||"",hash:b[8]||""}:null}function d(a,b){function d(a){var b=[];return a.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(a){"/.."===a?b.pop():b.push(a)}),b.join("").replace(/^\//,"/"===a.charAt(0)?"/":"")}return b=c(b||""),a=c(a||""),b&&a?(b.protocol||a.protocol)+(b.protocol||b.authority?b.authority:a.authority)+d(b.protocol||b.authority||"/"===b.pathname.charAt(0)?b.pathname:b.pathname?(a.authority&&!a.pathname?"/":"")+a.pathname.slice(0,a.pathname.lastIndexOf("/")+1)+b.pathname:a.pathname)+(b.protocol||b.authority||b.pathname?b.search:b.search||a.search)+b.hash:null}function e(a,b){if(void 0==b?b=a.id:"string"==typeof a.id&&(b=d(b,a.id),a.id=b),"object"==typeof a)if(Array.isArray(a))for(var c=0;c<a.length;c++)e(a[c],b);else if("string"==typeof a.$ref)a.$ref=d(b,a.$ref);else for(var f in a)"enum"!=f&&e(a[f],b)}function f(a,b,c,d,e){if(void 0==a)throw new Error("No code supplied for error: "+b);this.code=a,this.message=b,this.dataPath=c?c:"",this.schemaPath=d?d:"",this.subErrors=e?e:null}function g(a,b,c){if("string"==typeof b.id&&b.id.substring(0,c.length)==c){var d=b.id.substring(c.length);(c.length>0&&"/"==c.charAt(c.length-1)||"#"==d.charAt(0)||"?"==d.charAt(0))&&void 0==a[b.id]&&(a[b.id]=b)}if("object"==typeof b)for(var e in b)"enum"!=e&&"object"==typeof b[e]&&g(a,b[e],c);return a}function h(){var a=new i;return{freshApi:function(){return h()},validate:function(b,c){var d=new i(a);"string"==typeof c&&(c={$ref:c}),d.addSchema("",c);var e=d.validateAll(b,c);return this.error=e,this.missing=d.missing,this.valid=null==e,this.valid},validateResult:function(){var a={};return this.validate.apply(a,arguments),a},validateMultiple:function(b,c){var d=new i(a,!0);"string"==typeof c&&(c={$ref:c}),d.addSchema("",c),d.validateAll(b,c);var e={};return e.errors=d.errors,e.missing=d.missing,e.valid=0==e.errors.length,e},addSchema:function(b,c){return a.addSchema(b,c)},getSchema:function(b){return a.getSchema(b)},missing:[],error:null,normSchema:e,resolveUrl:d,errorCodes:j}}Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var f=[];for(var g in e)a.call(e,g)&&f.push(g);if(b)for(var h=0;d>h;h++)a.call(e,c[h])&&f.push(c[h]);return f}}()),Object.create||(Object.create=function(){function a(){}return function(b){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return a.prototype=b,new a}}()),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});var i=function(a,b){this.missing=[],this.schemas=a?Object.create(a.schemas):{},this.collectMultiple=b,this.errors=[],this.handleError=b?this.collectError:this.returnError};i.prototype.returnError=function(a){return a},i.prototype.collectError=function(a){return a&&this.errors.push(a),null},i.prototype.prefixErrors=function(a,b,c){for(var d=a;d<this.errors.length;d++)this.errors[d]=this.errors[d].prefixWith(b,c);return this},i.prototype.getSchema=function(a){if(void 0!=this.schemas[a]){var b=this.schemas[a];return b}var c=a,d="";if(-1!=a.indexOf("#")&&(d=a.substring(a.indexOf("#")+1),c=a.substring(0,a.indexOf("#"))),void 0!=this.schemas[c]){var b=this.schemas[c],e=decodeURIComponent(d);if(""==e)return b;if("/"!=e.charAt(0))return void 0;for(var f=e.split("/").slice(1),g=0;g<f.length;g++){var h=f[g].replace("~1","/").replace("~0","~");if(void 0==b[h]){b=void 0;break}b=b[h]}if(void 0!=b)return b}void 0==this.missing[c]&&(this.missing.push(c),this.missing[c]=c)},i.prototype.addSchema=function(a,b){var c={};c[a]=b,e(b,a),g(c,b,a);for(var d in c)this.schemas[d]=c[d];return c},i.prototype.validateAll=function(a,b,c,d){if(void 0!=b.$ref&&(b=this.getSchema(b.$ref),!b))return null;var e=this.errors.length,f=this.validateBasic(a,b)||this.validateNumeric(a,b)||this.validateString(a,b)||this.validateArray(a,b)||this.validateObject(a,b)||this.validateCombinations(a,b)||null;if(f||e!=this.errors.length)for(;c&&c.length||d&&d.length;){var g=c&&c.length?""+c.pop():null,h=d&&d.length?""+d.pop():null;f&&(f=f.prefixWith(g,h)),this.prefixErrors(e,g,h)}return this.handleError(f)},i.prototype.validateBasic=function(a,b){var c;return(c=this.validateType(a,b))?c.prefixWith(null,"type"):(c=this.validateEnum(a,b))?c.prefixWith(null,"type"):null},i.prototype.validateType=function(a,b){if(void 0==b.type)return null;var c=typeof a;null==a?c="null":Array.isArray(a)&&(c="array");var d=b.type;"object"!=typeof d&&(d=[d]);for(var e=0;e<d.length;e++){var g=d[e];if(g==c||"integer"==g&&"number"==c&&0==a%1)return null}return new f(j.INVALID_TYPE,"invalid data type: "+c)},i.prototype.validateEnum=function(a,c){if(void 0==c["enum"])return null;for(var d=0;d<c["enum"].length;d++){var e=c["enum"][d];if(b(a,e))return null}return new f(j.ENUM_MISMATCH,"No enum match for: "+JSON.stringify(a))},i.prototype.validateNumeric=function(a,b){return this.validateMultipleOf(a,b)||this.validateMinMax(a,b)||null},i.prototype.validateMultipleOf=function(a,b){var c=b.multipleOf||b.divisibleBy;return void 0==c?null:"number"==typeof a&&0!=a%c?new f(j.NUMBER_MULTIPLE_OF,"Value "+a+" is not a multiple of "+c):null},i.prototype.validateMinMax=function(a,b){if("number"!=typeof a)return null;if(void 0!=b.minimum){if(a<b.minimum)return new f(j.NUMBER_MINIMUM,"Value "+a+" is less than minimum "+b.minimum).prefixWith(null,"minimum");if(b.exclusiveMinimum&&a==b.minimum)return new f(j.NUMBER_MINIMUM_EXCLUSIVE,"Value "+a+" is equal to exclusive minimum "+b.minimum).prefixWith(null,"exclusiveMinimum")}if(void 0!=b.maximum){if(a>b.maximum)return new f(j.NUMBER_MAXIMUM,"Value "+a+" is greater than maximum "+b.maximum).prefixWith(null,"maximum");if(b.exclusiveMaximum&&a==b.maximum)return new f(j.NUMBER_MAXIMUM_EXCLUSIVE,"Value "+a+" is equal to exclusive maximum "+b.maximum).prefixWith(null,"exclusiveMaximum")}return null},i.prototype.validateString=function(a,b){return this.validateStringLength(a,b)||this.validateStringPattern(a,b)||null},i.prototype.validateStringLength=function(a,b){return"string"!=typeof a?null:void 0!=b.minLength&&a.length<b.minLength?new f(j.STRING_LENGTH_SHORT,"String is too short ("+a.length+" chars), minimum "+b.minLength).prefixWith(null,"minLength"):void 0!=b.maxLength&&a.length>b.maxLength?new f(j.STRING_LENGTH_LONG,"String is too long ("+a.length+" chars), maximum "+b.maxLength).prefixWith(null,"maxLength"):null},i.prototype.validateStringPattern=function(a,b){if("string"!=typeof a||void 0==b.pattern)return null;var c=new RegExp(b.pattern);return c.test(a)?null:new f(j.STRING_PATTERN,"String does not match pattern").prefixWith(null,"pattern")},i.prototype.validateArray=function(a,b){return Array.isArray(a)?this.validateArrayLength(a,b)||this.validateArrayUniqueItems(a,b)||this.validateArrayItems(a,b)||null:null},i.prototype.validateArrayLength=function(a,b){if(void 0!=b.minItems&&a.length<b.minItems){var c=new f(j.ARRAY_LENGTH_SHORT,"Array is too short ("+a.length+"), minimum "+b.minItems).prefixWith(null,"minItems");if(this.handleError(c))return c}if(void 0!=b.maxItems&&a.length>b.maxItems){var c=new f(j.ARRAY_LENGTH_LONG,"Array is too long ("+a.length+" chars), maximum "+b.maxItems).prefixWith(null,"maxItems");if(this.handleError(c))return c}return null},i.prototype.validateArrayUniqueItems=function(a,c){if(c.uniqueItems)for(var d=0;d<a.length;d++)for(var e=d+1;e<a.length;e++)if(b(a[d],a[e])){var g=new f(j.ARRAY_UNIQUE,"Array items are not unique (indices "+d+" and "+e+")").prefixWith(null,"uniqueItems");if(this.handleError(g))return g}return null},i.prototype.validateArrayItems=function(a,b){if(void 0==b.items)return null;var c;if(Array.isArray(b.items)){for(var d=0;d<a.length;d++)if(d<b.items.length){if(c=this.validateAll(a[d],b.items[d],[d],["items",d]))return c}else if(void 0!=b.additionalItems)if("boolean"==typeof b.additionalItems){if(!b.additionalItems&&(c=new f(j.ARRAY_ADDITIONAL_ITEMS,"Additional items not allowed").prefixWith(""+d,"additionalItems"),this.handleError(c)))return c}else if(c=this.validateAll(a[d],b.additionalItems,[d],["additionalItems"]))return c}else for(var d=0;d<a.length;d++)if(c=this.validateAll(a[d],b.items,[d],["items"]))return c;return null},i.prototype.validateObject=function(a,b){return"object"!=typeof a||null==a||Array.isArray(a)?null:this.validateObjectMinMaxProperties(a,b)||this.validateObjectRequiredProperties(a,b)||this.validateObjectProperties(a,b)||this.validateObjectDependencies(a,b)||null},i.prototype.validateObjectMinMaxProperties=function(a,b){var c=Object.keys(a);if(void 0!=b.minProperties&&c.length<b.minProperties){var d=new f(j.OBJECT_PROPERTIES_MINIMUM,"Too few properties defined ("+c.length+"), minimum "+b.minProperties).prefixWith(null,"minProperties");if(this.handleError(d))return d}if(void 0!=b.maxProperties&&c.length>b.maxProperties){var d=new f(j.OBJECT_PROPERTIES_MAXIMUM,"Too many properties defined ("+c.length+"), maximum "+b.maxProperties).prefixWith(null,"maxProperties");if(this.handleError(d))return d}return null},i.prototype.validateObjectRequiredProperties=function(a,b){if(void 0!=b.required)for(var c=0;c<b.required.length;c++){var d=b.required[c];if(void 0===a[d]){var e=new f(j.OBJECT_REQUIRED,"Missing required property: "+d).prefixWith(null,""+c).prefixWith(null,"required");if(this.handleError(e))return e}}return null},i.prototype.validateObjectProperties=function(a,b){var c;for(var d in a){var e=!1;if(void 0!=b.properties&&void 0!=b.properties[d]&&(e=!0,c=this.validateAll(a[d],b.properties[d],[d],["properties",d])))return c;if(void 0!=b.patternProperties)for(var g in b.patternProperties){var h=new RegExp(g);if(h.test(d)&&(e=!0,c=this.validateAll(a[d],b.patternProperties[g],[d],["patternProperties",g])))return c}if(!e&&void 0!=b.additionalProperties)if("boolean"==typeof b.additionalProperties){if(!b.additionalProperties&&(c=new f(j.OBJECT_ADDITIONAL_PROPERTIES,"Additional properties not allowed").prefixWith(d,"additionalProperties"),this.handleError(c)))return c}else if(c=this.validateAll(a[d],b.additionalProperties,[d],["additionalProperties"]))return c}return null},i.prototype.validateObjectDependencies=function(a,b){var c;if(void 0!=b.dependencies)for(var d in b.dependencies)if(void 0!==a[d]){var e=b.dependencies[d];if("string"==typeof e){if(void 0===a[e]&&(c=new f(j.OBJECT_DEPENDENCY_KEY,"Dependency failed - key must exist: "+e).prefixWith(null,d).prefixWith(null,"dependencies"),this.handleError(c)))return c}else if(Array.isArray(e))for(var g=0;g<e.length;g++){var h=e[g];if(void 0===a[h]&&(c=new f(j.OBJECT_DEPENDENCY_KEY,"Dependency failed - key must exist: "+h).prefixWith(null,""+g).prefixWith(null,d).prefixWith(null,"dependencies"),this.handleError(c)))return c}else if(c=this.validateAll(a,e,[],["dependencies",d]))return c}return null},i.prototype.validateCombinations=function(a,b){return this.validateAllOf(a,b)||this.validateAnyOf(a,b)||this.validateOneOf(a,b)||this.validateNot(a,b)||null},i.prototype.validateAllOf=function(a,b){if(void 0==b.allOf)return null;for(var c,d=0;d<b.allOf.length;d++){var e=b.allOf[d];if(c=this.validateAll(a,e,[],["allOf",d]))return c}return null},i.prototype.validateAnyOf=function(a,b){if(void 0==b.anyOf)return null;for(var c=[],d=this.errors.length,e=0;e<b.anyOf.length;e++){var g=b.anyOf[e],h=this.errors.length,i=this.validateAll(a,g,[],["anyOf",e]);if(null==i&&h==this.errors.length)return this.errors=this.errors.slice(0,d),null;i&&c.push(i.prefixWith(null,""+e).prefixWith(null,"anyOf"))}return c=c.concat(this.errors.slice(d)),this.errors=this.errors.slice(0,d),new f(j.ANY_OF_MISSING,'Data does not match any schemas from "anyOf"',"","/anyOf",c)},i.prototype.validateOneOf=function(a,b){if(void 0==b.oneOf)return null;for(var c=null,d=[],e=this.errors.length,g=0;g<b.oneOf.length;g++){var h=b.oneOf[g],i=this.errors.length,k=this.validateAll(a,h,[],["oneOf",g]);if(null==k&&i==this.errors.length){if(null!=c)return this.errors=this.errors.slice(0,e),new f(j.ONE_OF_MULTIPLE,'Data is valid against more than one schema from "oneOf": indices '+c+" and "+g,"","/oneOf");c=g}else k&&d.push(k.prefixWith(null,""+g).prefixWith(null,"oneOf"))}return null==c?(d=d.concat(this.errors.slice(e)),this.errors=this.errors.slice(0,e),new f(j.ONE_OF_MISSING,'Data does not match any schemas from "oneOf"',"","/oneOf",d)):(this.errors=this.errors.slice(0,e),null)},i.prototype.validateNot=function(a,b){if(void 0==b.not)return null;var c=this.errors.length,d=this.validateAll(a,b.not),e=this.errors.slice(c);return this.errors=this.errors.slice(0,c),null==d&&0==e.length?new f(j.NOT_PASSED,'Data matches schema from "not"',"","/not"):null};var j={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403};f.prototype={prefixWith:function(a,b){if(null!=a&&(a=a.replace("~","~0").replace("/","~1"),this.dataPath="/"+a+this.dataPath),null!=b&&(b=b.replace("~","~0").replace("/","~1"),this.schemaPath="/"+b+this.schemaPath),null!=this.subErrors)for(var c=0;c<this.subErrors.length;c++)this.subErrors[c].prefixWith(a,b);return this}},a.tv4=h()}("undefined"!=typeof module&&module.exports?exports:this);